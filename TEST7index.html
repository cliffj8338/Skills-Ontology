<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cliff Jurkiewicz - Skills Manager</title>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 100%);
            color: #e0e0e0;
            overflow-x: hidden;
        }
        
        .header {
            background: rgba(26, 26, 46, 0.8);
            border-bottom: 1px solid rgba(96, 165, 250, 0.2);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .header-left h1 {
            color: #60a5fa;
            font-size: 1.8em;
            margin-bottom: 5px;
        }
        
        .header-left .subtitle {
            color: #9ca3af;
            font-size: 0.9em;
        }
        
        .header-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .view-toggle {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(96, 165, 250, 0.3);
            border-radius: 8px;
            display: flex;
            overflow: hidden;
        }
        
        .view-toggle button {
            background: transparent;
            border: none;
            color: #9ca3af;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }
        
        .view-toggle button.active {
            background: #60a5fa;
            color: #fff;
        }
        
        .export-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border: none;
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
        }
        
        .controls {
            background: rgba(26, 26, 46, 0.6);
            border-bottom: 1px solid rgba(96, 165, 250, 0.1);
            padding: 15px 30px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        
        .controls-left {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .controls-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .filter-label {
            color: #9ca3af;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .role-chip {
            background: rgba(96, 165, 250, 0.1);
            border: 1px solid rgba(96, 165, 250, 0.3);
            padding: 6px 12px;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85em;
        }
        
        .role-chip:hover {
            background: rgba(96, 165, 250, 0.2);
            border-color: rgba(96, 165, 250, 0.5);
        }
        
        .role-chip.active {
            background: #60a5fa;
            color: #fff;
            border-color: #60a5fa;
        }
        
        .level-filter {
            display: flex;
            gap: 8px;
        }
        
        .level-chip {
            padding: 6px 12px;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85em;
            border: 1px solid transparent;
        }
        
        .level-chip.mastery {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .level-chip.mastery.active {
            background: #ef4444;
            color: #fff;
        }
        
        .level-chip.advanced {
            background: rgba(245, 158, 11, 0.2);
            border-color: rgba(245, 158, 11, 0.3);
        }
        
        .level-chip.advanced.active {
            background: #f59e0b;
            color: #fff;
        }
        
        .level-chip.proficient {
            background: rgba(16, 185, 129, 0.2);
            border-color: rgba(16, 185, 129, 0.3);
        }
        
        .level-chip.proficient.active {
            background: #10b981;
            color: #fff;
        }
        
        .label-toggle {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(96, 165, 250, 0.3);
            transition: .3s;
            border-radius: 20px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #60a5fa;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }
        
        .toggle-label {
            font-size: 0.85em;
            color: #9ca3af;
        }
        
        .main-content {
            position: relative;
            height: calc(100vh - 160px);
        }
        
        #networkView {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        #cardView {
            display: none;
            padding: 30px;
            height: 100%;
            overflow-y: auto;
        }
        
        #opportunitiesView {
            display: none;
            padding: 30px;
            height: 100%;
            overflow-y: auto;
        }
        
        .opportunities-header {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        
        .opportunities-title {
            font-size: 2em;
            color: #60a5fa;
            margin-bottom: 10px;
        }
        
        .opportunities-subtitle {
            color: #9ca3af;
            font-size: 1.1em;
            margin-bottom: 30px;
        }
        
        .opportunities-filters {
            background: rgba(26, 26, 46, 0.6);
            border: 1px solid rgba(96, 165, 250, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .filter-section-label {
            color: #60a5fa;
            font-size: 0.85em;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .match-slider {
            width: 200px;
        }
        
        .match-value {
            color: #fbbf24;
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .opportunities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .opportunity-card {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.8) 0%, rgba(26, 26, 46, 0.6) 100%);
            border: 1px solid rgba(96, 165, 250, 0.2);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .opportunity-card:hover {
            border-color: rgba(96, 165, 250, 0.5);
            transform: translateY(-2px);
        }
        
        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .opportunity-company {
            font-size: 0.9em;
            color: #9ca3af;
            margin-bottom: 5px;
        }
        
        .opportunity-title {
            font-size: 1.2em;
            color: #e0e0e0;
            font-weight: 600;
            line-height: 1.3;
        }
        
        .match-score {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .match-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            font-weight: bold;
            position: relative;
        }
        
        .match-circle.high {
            background: radial-gradient(circle, rgba(16, 185, 129, 0.2) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 3px solid #10b981;
            color: #10b981;
        }
        
        .match-circle.medium {
            background: radial-gradient(circle, rgba(245, 158, 11, 0.2) 0%, rgba(245, 158, 11, 0.05) 100%);
            border: 3px solid #f59e0b;
            color: #f59e0b;
        }
        
        .match-circle.low {
            background: radial-gradient(circle, rgba(107, 114, 128, 0.2) 0%, rgba(107, 114, 128, 0.05) 100%);
            border: 3px solid #6b7280;
            color: #6b7280;
        }
        
        .match-label {
            font-size: 0.75em;
            color: #9ca3af;
            text-transform: uppercase;
        }
        
        .opportunity-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.85em;
            color: #9ca3af;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .matched-skills {
            margin-bottom: 15px;
        }
        
        .matched-skills-title {
            font-size: 0.85em;
            color: #60a5fa;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .skill-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .skill-chip-match {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
        }
        
        .skill-chip-gap {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
        }
        
        .opportunity-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(96, 165, 250, 0.1);
        }
        
        .action-btn {
            flex: 1;
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid rgba(96, 165, 250, 0.3);
            background: rgba(96, 165, 250, 0.1);
            color: #60a5fa;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .action-btn:hover {
            background: rgba(96, 165, 250, 0.2);
            border-color: rgba(96, 165, 250, 0.5);
        }
        
        .loading-state {
            text-align: center;
            padding: 60px 20px;
            color: #9ca3af;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(96, 165, 250, 0.2);
            border-top-color: #60a5fa;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .domain-card {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.8) 0%, rgba(26, 26, 46, 0.6) 100%);
            border: 1px solid rgba(96, 165, 250, 0.2);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .domain-card:hover {
            border-color: rgba(96, 165, 250, 0.5);
            transform: translateY(-2px);
        }
        
        .domain-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(96, 165, 250, 0.2);
        }
        
        .domain-icon {
            font-size: 24px;
        }
        
        .domain-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #60a5fa;
        }
        
        .skill-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border-left: 3px solid transparent;
            margin-bottom: 8px;
        }
        
        .skill-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .skill-name {
            flex: 1;
            font-size: 0.95em;
        }
        
        .skill-badge {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75em;
        }
        
        .skill-years {
            background: rgba(96, 165, 250, 0.15);
            color: #60a5fa;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75em;
            margin-left: auto;
        }
        
        /* Network styles */
        .node circle {
            stroke: #fff;
            stroke-width: 2px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .node.dimmed circle {
            opacity: 0.2;
        }
        
        .node.highlighted circle {
            stroke-width: 4px;
            filter: brightness(1.3);
        }
        
        .node text {
            font-size: 11px;
            pointer-events: none;
            text-shadow: 0 0 4px #000, 0 0 4px #000, 0 0 4px #000;
            fill: #e0e0e0;
            display: block;
        }
        
        .node text.hidden {
            display: none;
        }
        
        .node.role text {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .node.center text {
            font-size: 16px;
            font-weight: bold;
            fill: #60a5fa;
            text-shadow: 0 0 6px #000, 0 0 6px #000;
        }
        
        .node.skill text {
            font-size: 10px;
        }
        
        .link {
            stroke: #4a5568;
            stroke-opacity: 0.3;
            stroke-width: 1.5px;
            fill: none;
        }
        
        .link.dimmed {
            opacity: 0.1;
        }
        
        .link.highlighted {
            stroke: #60a5fa;
            stroke-opacity: 0.8;
            stroke-width: 2.5px;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(26, 26, 46, 0.98);
            border: 1px solid #60a5fa;
            border-radius: 8px;
            padding: 15px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            max-width: 350px;
            font-size: 13px;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .tooltip-title {
            font-weight: bold;
            color: #60a5fa;
            margin-bottom: 8px;
            font-size: 15px;
        }
        
        .tooltip-level {
            color: #fbbf24;
            font-size: 12px;
            margin-bottom: 8px;
        }
        
        .tooltip-roles {
            color: #d1d5db;
            line-height: 1.6;
        }
        
        .tooltip-role-tag {
            display: inline-block;
            background: rgba(96, 165, 250, 0.2);
            padding: 2px 8px;
            border-radius: 10px;
            margin: 2px;
            font-size: 11px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: #1a1a2e;
            border: 1px solid rgba(96, 165, 250, 0.3);
            border-radius: 12px;
            padding: 0;
            max-width: 900px;
            max-height: 85vh;
            overflow: hidden;
            width: 90%;
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 30px 30px 20px 30px;
            border-bottom: 1px solid rgba(96, 165, 250, 0.2);
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.8) 0%, rgba(26, 26, 46, 0.6) 100%);
        }
        
        .modal-header-left {
            flex: 1;
        }
        
        .modal-title {
            font-size: 1.8em;
            color: #60a5fa;
            margin-bottom: 10px;
            line-height: 1.3;
        }
        
        .modal-subtitle {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .modal-level-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .modal-level-badge.mastery {
            background: #ef4444;
            color: #fff;
        }
        
        .modal-level-badge.advanced {
            background: #f59e0b;
            color: #fff;
        }
        
        .modal-level-badge.proficient {
            background: #10b981;
            color: #fff;
        }
        
        .modal-years {
            color: #9ca3af;
            font-size: 0.9em;
        }
        
        .modal-core-badge {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #000;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 700;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 2em;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }
        
        .modal-body {
            padding: 30px;
            overflow-y: auto;
            flex: 1;
        }
        
        .modal-section {
            margin-bottom: 30px;
        }
        
        .modal-section:last-child {
            margin-bottom: 0;
        }
        
        .modal-section-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #60a5fa;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-section-icon {
            font-size: 1.2em;
        }
        
        .evidence-list {
            list-style: none;
            padding: 0;
        }
        
        .evidence-item {
            background: rgba(96, 165, 250, 0.05);
            border-left: 3px solid #60a5fa;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            line-height: 1.6;
        }
        
        .evidence-item strong {
            color: #60a5fa;
        }
        
        .story-text {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 8px;
            line-height: 1.7;
            color: #d1d5db;
        }
        
        .roles-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .role-tag {
            background: rgba(96, 165, 250, 0.2);
            border: 1px solid rgba(96, 165, 250, 0.3);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .related-skills {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .related-skill-chip {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .related-skill-chip:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-2px);
        }
        
        .placeholder-text {
            color: #6b7280;
            font-style: italic;
            font-size: 0.9em;
        }
        
        .export-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .export-option {
            background: rgba(96, 165, 250, 0.1);
            border: 1px solid rgba(96, 165, 250, 0.3);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .export-option:hover {
            background: rgba(96, 165, 250, 0.2);
            transform: translateY(-2px);
        }
        
        .export-option-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .export-option-desc {
            font-size: 0.85em;
            color: #9ca3af;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>Skills Management System</h1>
            <div class="subtitle">73 Skills â€¢ 9 Career Roles â€¢ Interactive Ontology</div>
        </div>
        <div class="header-right">
            <div class="view-toggle">
                <button class="active" onclick="switchView('network')">Network View</button>
                <button onclick="switchView('card')">Card View</button>
                <button onclick="switchView('opportunities')">Opportunities</button>
            </div>
            <button class="export-btn" onclick="openExportModal()">Export Profile</button>
        </div>
    </div>
    
    <div class="controls">
        <div class="controls-left">
            <div class="filter-group">
                <span class="filter-label">ROLES:</span>
                <div class="role-chip active" data-role="all" onclick="filterByRole('all')">All</div>
                <div class="role-chip" data-role="strategy" onclick="filterByRole('strategy')">VP Strategy</div>
                <div class="role-chip" data-role="futurist" onclick="filterByRole('futurist')">Futurist</div>
                <div class="role-chip" data-role="pilot" onclick="filterByRole('pilot')">Pilot</div>
                <div class="role-chip" data-role="musician" onclick="filterByRole('musician')">Musician</div>
                <div class="role-chip" data-role="advocate" onclick="filterByRole('advocate')">Advocate</div>
                <div class="role-chip" data-role="tech" onclick="filterByRole('tech')">Tech</div>
                <div class="role-chip" data-role="creative" onclick="filterByRole('creative')">Creative</div>
                <div class="role-chip" data-role="operations" onclick="filterByRole('operations')">Operations</div>
                <div class="role-chip" data-role="entrepreneur" onclick="filterByRole('entrepreneur')">Entrepreneur</div>
            </div>
            
            <div class="filter-group">
                <span class="filter-label">LEVELS:</span>
                <div class="level-filter">
                    <div class="level-chip mastery" onclick="filterByLevel('mastery')">Mastery (33)</div>
                    <div class="level-chip advanced" onclick="filterByLevel('advanced')">Advanced (35)</div>
                    <div class="level-chip proficient" onclick="filterByLevel('proficient')">Proficient (3)</div>
                </div>
            </div>
        </div>
        
        <div class="controls-right" id="networkControls" style="display: flex;">
            <div class="label-toggle">
                <span class="toggle-label">Role Labels</span>
                <label class="toggle-switch">
                    <input type="checkbox" checked onchange="toggleLabels('role')">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="label-toggle">
                <span class="toggle-label">Skill Labels</span>
                <label class="toggle-switch">
                    <input type="checkbox" checked onchange="toggleLabels('skill')">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
    </div>
    
    <div class="main-content">
        <svg id="networkView"></svg>
        <div id="cardView"></div>
        <div id="opportunitiesView"></div>
    </div>
    
    <div class="tooltip" id="tooltip"></div>
    
    <!-- Skill Detail Modal -->
    <div class="modal" id="skillModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-left">
                    <h2 class="modal-title" id="skillDetailTitle"></h2>
                    <div class="modal-subtitle" id="skillDetailSubtitle"></div>
                </div>
                <button class="modal-close" onclick="closeSkillModal()">Ã—</button>
            </div>
            <div class="modal-body" id="skillDetailBody"></div>
        </div>
    </div>
    
    <!-- Export Modal -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-left">
                    <h2 class="modal-title">Export Profile</h2>
                </div>
                <button class="modal-close" onclick="closeExportModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <p style="color: #9ca3af; margin-bottom: 20px;">Select a format to export your skills profile:</p>
                <div class="export-options">
                    <div class="export-option" onclick="exportProfile('resume')">
                        <div class="export-option-title">ðŸ“„ Resume</div>
                        <div class="export-option-desc">Classic resume format</div>
                    </div>
                    <div class="export-option" onclick="exportProfile('capability')">
                        <div class="export-option-title">ðŸŽ¯ Capability Statement</div>
                        <div class="export-option-desc">One-page overview</div>
                    </div>
                    <div class="export-option" onclick="exportProfile('linkedin')">
                        <div class="export-option-title">ðŸ’¼ LinkedIn Profile</div>
                        <div class="export-option-desc">Profile sections</div>
                    </div>
                    <div class="export-option" onclick="exportProfile('interview')">
                        <div class="export-option-title">ðŸ’¬ Interview Prep</div>
                        <div class="export-option-desc">STAR stories</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data structure
        const skillsData = {
            roles: [
                { id: "strategy", name: "VP Global Strategy", icon: "ðŸŽ¯", color: "#ef4444" },
                { id: "futurist", name: "Futurist & Evangelist", icon: "ðŸ”®", color: "#f59e0b" },
                { id: "pilot", name: "IFR Pilot", icon: "âœˆï¸", color: "#3b82f6" },
                { id: "musician", name: "Musician", icon: "ðŸŽµ", color: "#8b5cf6" },
                { id: "advocate", name: "Recovery Advocate", icon: "ðŸ’š", color: "#10b981" },
                { id: "tech", name: "Technology Strategist", icon: "âš™ï¸", color: "#06b6d4" },
                { id: "creative", name: "Creative Director", icon: "ðŸŽ¨", color: "#ec4899" },
                { id: "operations", name: "Operations Leader", icon: "ðŸ”", color: "#f97316" },
                { id: "entrepreneur", name: "Entrepreneur", icon: "ðŸš€", color: "#a855f7" }
            ],
            
            skills: [
                // Strategic Core
                { name: "Enterprise AI Strategy", level: "Mastery", roles: ["strategy", "futurist", "tech"], key: false },
                { name: "Go-to-Market Strategy", level: "Advanced", roles: ["strategy", "tech", "entrepreneur"], key: false },
                { name: "Business Case Development", level: "Advanced", roles: ["strategy", "tech", "entrepreneur"], key: false },
                { name: "C-Suite Advisory & Influence", level: "Advanced", roles: ["strategy", "futurist"], key: false },
                { name: "Customer Advisory Board Leadership", level: "Mastery", roles: ["strategy"], key: false },
                { name: "Strategic Foresight & Market Prediction", level: "Mastery", roles: ["strategy", "futurist"], key: true },
                { name: "Organizational Transformation", level: "Advanced", roles: ["strategy", "tech", "entrepreneur"], key: false },
                { name: "Risk Assessment & Mitigation", level: "Mastery", roles: ["strategy", "pilot", "operations", "entrepreneur"], key: false },
                { name: "Revenue Pipeline Development", level: "Advanced", roles: ["strategy", "operations", "entrepreneur"], key: false },
                { name: "Financial Management & Budget Discipline", level: "Proficient", roles: ["strategy", "operations", "entrepreneur"], key: false },
                
                // Technology & Product
                { name: "AI/ML Product Strategy", level: "Mastery", roles: ["strategy", "tech", "futurist"], key: false },
                { name: "Talent Intelligence Platform Design", level: "Mastery", roles: ["strategy", "tech"], key: false },
                { name: "HR Technology Market Intelligence", level: "Mastery", roles: ["strategy", "futurist"], key: false },
                { name: "Technology Lifecycle & Disruption Analysis", level: "Mastery", roles: ["futurist", "tech"], key: false },
                { name: "Computational & Systems Thinking", level: "Advanced", roles: ["tech", "pilot"], key: false },
                { name: "Platform Integration Architecture", level: "Advanced", roles: ["tech", "entrepreneur"], key: false },
                { name: "Weak Signal Detection & Trend Recognition", level: "Mastery", roles: ["futurist", "strategy"], key: true },
                { name: "Spatial Reasoning & 3D Problem Solving", level: "Mastery", roles: ["pilot", "musician", "creative", "tech"], key: true },
                
                // Futurist & Innovation
                { name: "Technology Trend Forecasting", level: "Mastery", roles: ["futurist", "strategy"], key: true },
                { name: "Predictive Framework Development", level: "Mastery", roles: ["futurist", "strategy"], key: true },
                { name: "Disruptive Innovation Identification", level: "Mastery", roles: ["futurist", "strategy"], key: false },
                { name: "Scenario Planning & Strategic Alternatives", level: "Advanced", roles: ["strategy", "futurist"], key: false },
                { name: "Human-AI Collaboration Model Design", level: "Mastery", roles: ["futurist", "strategy"], key: true },
                
                // Communication & Influence
                { name: "Executive Narrative & Storytelling", level: "Mastery", roles: ["futurist", "strategy"], key: false },
                { name: "Technical Concept Translation", level: "Mastery", roles: ["futurist", "tech", "strategy"], key: true },
                { name: "Public Speaking & Keynote Delivery", level: "Mastery", roles: ["futurist", "musician"], key: false },
                { name: "Thought Leadership Authorship", level: "Mastery", roles: ["futurist"], key: false },
                { name: "Rhetorical Strategy & Persuasion", level: "Mastery", roles: ["futurist", "strategy"], key: false },
                { name: "Media Relations & Spokesperson Work", level: "Mastery", roles: ["futurist"], key: false },
                { name: "Podcast Production & Hosting", level: "Advanced", roles: ["futurist", "musician"], key: false },
                { name: "Real-Time Improvisation", level: "Mastery", roles: ["musician", "futurist"], key: false },
                { name: "Industry Evangelism", level: "Mastery", roles: ["futurist"], key: false },
                { name: "Teaching & Knowledge Transfer", level: "Advanced", roles: ["futurist", "advocate"], key: false },
                
                // Domain Expertise
                { name: "Talent Acquisition Strategy", level: "Mastery", roles: ["strategy"], key: false },
                { name: "Candidate Experience Architecture", level: "Mastery", roles: ["strategy"], key: true },
                { name: "AI Ethics & Responsible Implementation", level: "Advanced", roles: ["strategy", "futurist"], key: false },
                { name: "Workforce Intelligence & Analytics", level: "Mastery", roles: ["strategy"], key: false },
                { name: "Talent Marketplace Dynamics", level: "Advanced", roles: ["strategy", "futurist"], key: false },
                { name: "Behavioral Economics in Talent", level: "Advanced", roles: ["strategy", "futurist"], key: false },
                { name: "Future of Work Anthropology", level: "Mastery", roles: ["futurist", "strategy"], key: false },
                { name: "Generational Workforce Analysis", level: "Advanced", roles: ["futurist", "strategy"], key: false },
                { name: "AI Impact on Human Work", level: "Mastery", roles: ["futurist", "strategy"], key: false },
                
                // Leadership & Interpersonal
                { name: "Enterprise Client Relationship Management", level: "Mastery", roles: ["strategy", "entrepreneur"], key: false },
                { name: "Strategic Team Building", level: "Advanced", roles: ["strategy", "operations", "tech", "entrepreneur"], key: false },
                { name: "Executive Mentorship", level: "Advanced", roles: ["strategy"], key: false },
                { name: "Multi-Stakeholder Alignment", level: "Advanced", roles: ["strategy", "tech", "entrepreneur"], key: false },
                { name: "Executive Presence & Authority", level: "Mastery", roles: ["strategy", "futurist"], key: false },
                { name: "Crisis Leadership & Decision Making", level: "Mastery", roles: ["pilot", "operations", "advocate", "strategy", "entrepreneur"], key: true },
                { name: "High-Pressure Performance", level: "Mastery", roles: ["pilot", "musician", "operations"], key: false },
                
                // Creative & Performance
                { name: "Creative Direction", level: "Mastery", roles: ["creative", "entrepreneur"], key: false },
                { name: "Live Musical Performance", level: "Mastery", roles: ["musician"], key: false },
                { name: "Music Composition & Arrangement", level: "Advanced", roles: ["musician"], key: false },
                { name: "Music Production & Artist Development", level: "Advanced", roles: ["musician"], key: false },
                { name: "Stage Command & Audience Connection", level: "Mastery", roles: ["musician", "futurist"], key: false },
                { name: "Performance Logistics", level: "Proficient", roles: ["musician"], key: false },
                
                // Aviation
                { name: "Single-Pilot IFR in Complex Airspace", level: "Mastery", roles: ["pilot"], key: false },
                { name: "Single-Pilot Resource Management", level: "Mastery", roles: ["pilot"], key: false },
                { name: "Weather Systems Analysis", level: "Advanced", roles: ["pilot"], key: false },
                { name: "ATC Communication & Coordination", level: "Mastery", roles: ["pilot"], key: false },
                { name: "Emergency Airmanship", level: "Mastery", roles: ["pilot"], key: true },
                { name: "Aeronautical Decision Making Under Uncertainty", level: "Mastery", roles: ["pilot"], key: false },
                { name: "Situational Awareness in Dynamic Environments", level: "Mastery", roles: ["pilot", "operations"], key: false },
                { name: "Multi-Channel Cognitive Load Management", level: "Mastery", roles: ["pilot", "operations"], key: false },
                
                // Analytical & Research
                { name: "Data-Driven Strategy Development", level: "Advanced", roles: ["strategy", "tech"], key: false },
                { name: "Market & Competitive Intelligence", level: "Advanced", roles: ["strategy", "futurist"], key: false },
                { name: "Research Synthesis & Pattern Recognition", level: "Mastery", roles: ["futurist", "strategy"], key: true },
                { name: "Critical Analysis & Evaluation", level: "Advanced", roles: ["strategy", "tech", "futurist"], key: false },
                
                // Advocacy
                { name: "Recovery Leadership & Peer Mentorship", level: "Mastery", roles: ["advocate"], key: false },
                { name: "Mental Health & Addiction Advocacy", level: "Mastery", roles: ["advocate"], key: false },
                { name: "Nonprofit Founding & Operations", level: "Advanced", roles: ["advocate", "entrepreneur"], key: false },
                { name: "Public Vulnerability as Leadership Tool", level: "Mastery", roles: ["advocate", "futurist"], key: true },
                { name: "Stigma Reduction Through Education", level: "Advanced", roles: ["advocate"], key: false },
                { name: "Dual Diagnosis Navigation", level: "Advanced", roles: ["advocate"], key: false }
            ],
            
            skillDetails: {} // Will be loaded from skill_evidence.json
        };
        
        // Load skill evidence dynamically
        fetch('skill_evidence.json')
            .then(response => response.json())
            .then(data => {
                skillsData.skillDetails = data;
                console.log('âœ“ Loaded evidence for', Object.keys(data).length, 'skills');
            })
            .catch(error => console.error('Error loading skill evidence:', error));

        const levelColors = {
            "Mastery": "#ef4444",
            "Advanced": "#f59e0b",
            "Proficient": "#10b981"
        };

        let currentView = 'network';
        let activeRole = 'all';
        let activeLevel = null;
        let simulation;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initNetwork();
            initCardView();
        });

        function initNetwork() {
            const width = window.innerWidth;
            const height = window.innerHeight - 160;
            
            const svg = d3.select("#networkView")
                .attr("width", width)
                .attr("height", height);

            svg.selectAll("*").remove();

            // Create nodes
            const nodes = [
                { id: "center", name: "Cliff Jurkiewicz", type: "center", x: width/2, y: height/2, fx: width/2, fy: height/2 }
            ];

            // Add role nodes
            skillsData.roles.forEach((role, i) => {
                const angle = (i / skillsData.roles.length) * 2 * Math.PI;
                const radius = 200;
                nodes.push({
                    id: role.id,
                    name: role.name,
                    type: "role",
                    color: role.color,
                    x: width/2 + Math.cos(angle) * radius,
                    y: height/2 + Math.sin(angle) * radius
                });
            });

            // Add skill nodes
            skillsData.skills.forEach((skill, i) => {
                nodes.push({
                    id: `skill-${i}`,
                    name: skill.name,
                    type: "skill",
                    level: skill.level,
                    roles: skill.roles,
                    key: skill.key
                });
            });

            // Create links
            const links = [];
            
            // Center to roles
            skillsData.roles.forEach(role => {
                links.push({ source: "center", target: role.id, type: "role" });
            });

            // Roles to skills
            skillsData.skills.forEach((skill, i) => {
                skill.roles.forEach(roleId => {
                    links.push({ 
                        source: roleId, 
                        target: `skill-${i}`,
                        type: "skill"
                    });
                });
            });

            // Create simulation
            simulation = d3.forceSimulation(nodes)
                .force("link", d3.forceLink(links).id(d => d.id).distance(d => d.type === "role" ? 100 : 150))
                .force("charge", d3.forceManyBody().strength(d => d.type === "center" ? 0 : -100))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .force("collision", d3.forceCollide().radius(d => d.type === "role" ? 50 : 30));

            // Draw links
            const link = svg.append("g")
                .selectAll("line")
                .data(links)
                .join("line")
                .attr("class", "link");

            // Draw nodes
            const node = svg.append("g")
                .selectAll("g")
                .data(nodes)
                .join("g")
                .attr("class", d => `node ${d.type}`)
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));

            node.append("circle")
                .attr("r", d => {
                    if (d.type === "center") return 40;
                    if (d.type === "role") return 30;
                    return d.key ? 12 : 8;
                })
                .attr("fill", d => {
                    if (d.type === "center") return "#60a5fa";
                    if (d.type === "role") return d.color;
                    return levelColors[d.level];
                })
                .on("click", (event, d) => {
                    if (d.type === "role") {
                        filterByRole(d.id);
                    } else if (d.type === "skill") {
                        event.stopPropagation();
                        openSkillModal(d.name, d);
                    }
                })
                .on("mouseover", (event, d) => showTooltip(event, d))
                .on("mouseout", hideTooltip);

            node.append("text")
                .each(function(d) {
                    if (d.type === 'skill') {
                        // Split long skill names into multiple lines
                        const words = d.name.split(' ');
                        const maxWidth = 15; // characters per line
                        let lines = [];
                        let currentLine = '';
                        
                        words.forEach(word => {
                            if ((currentLine + ' ' + word).length > maxWidth && currentLine.length > 0) {
                                lines.push(currentLine);
                                currentLine = word;
                            } else {
                                currentLine = currentLine ? currentLine + ' ' + word : word;
                            }
                        });
                        if (currentLine) lines.push(currentLine);
                        
                        // Create tspan for each line
                        const text = d3.select(this);
                        lines.forEach((line, i) => {
                            text.append('tspan')
                                .text(line)
                                .attr('x', 0)
                                .attr('dy', i === 0 ? -13 - (lines.length - 1) * 5 : 10)
                                .attr('text-anchor', 'middle');
                        });
                    } else {
                        // Single line for center and role nodes
                        d3.select(this)
                            .text(d.name)
                            .attr("x", 0)
                            .attr("y", d => {
                                if (d.type === "center") return -45;
                                if (d.type === "role") return -35;
                                return -13;
                            })
                            .attr("text-anchor", "middle");
                    }
                });

            simulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });

            window.networkData = { nodes, links, svg, link, node };
        }

        function initCardView() {
            const cardView = document.getElementById('cardView');
            
            // Group skills by domain
            const domains = {
                "Strategic Core": { icon: "ðŸŽ¯", skills: [] },
                "Technology & Product": { icon: "âš™ï¸", skills: [] },
                "Futurist & Innovation": { icon: "ðŸ”®", skills: [] },
                "Communication & Influence": { icon: "ðŸ“£", skills: [] },
                "Domain Expertise": { icon: "ðŸŽ“", skills: [] },
                "Leadership & Interpersonal": { icon: "ðŸ‘¥", skills: [] },
                "Creative & Performance": { icon: "ðŸŽµ", skills: [] },
                "Aviation & Operational": { icon: "âœˆï¸", skills: [] },
                "Analytical & Research": { icon: "ðŸ”¬", skills: [] },
                "Advocacy & Lived Experience": { icon: "ðŸ’š", skills: [] }
            };
            
            // Categorize skills
            skillsData.skills.forEach(skill => {
                const skillName = skill.name;
                
                if (skillName.includes("Strategy") || skillName.includes("Business") || skillName.includes("Revenue") || skillName.includes("Financial") || skillName.includes("Risk") || skillName.includes("Advisory") || skillName.includes("Transformation")) {
                    domains["Strategic Core"].skills.push(skill);
                } else if (skillName.includes("AI/ML") || skillName.includes("Technology") || skillName.includes("Platform") || skillName.includes("Computational") || skillName.includes("Integration") || skillName.includes("Spatial")) {
                    domains["Technology & Product"].skills.push(skill);
                } else if (skillName.includes("Trend") || skillName.includes("Predictive") || skillName.includes("Innovation") || skillName.includes("Scenario") || skillName.includes("Human-AI") || skillName.includes("Weak Signal")) {
                    domains["Futurist & Innovation"].skills.push(skill);
                } else if (skillName.includes("Narrative") || skillName.includes("Translation") || skillName.includes("Speaking") || skillName.includes("Authorship") || skillName.includes("Rhetorical") || skillName.includes("Media") || skillName.includes("Podcast") || skillName.includes("Improvisation") || skillName.includes("Evangelism") || skillName.includes("Teaching")) {
                    domains["Communication & Influence"].skills.push(skill);
                } else if (skillName.includes("Talent") || skillName.includes("Candidate") || skillName.includes("Ethics") || skillName.includes("Workforce") || skillName.includes("Marketplace") || skillName.includes("Behavioral") || skillName.includes("Future of Work") || skillName.includes("Generational") || skillName.includes("AI Impact")) {
                    domains["Domain Expertise"].skills.push(skill);
                } else if (skillName.includes("Client Relationship") || skillName.includes("Team Building") || skillName.includes("Mentorship") || skillName.includes("Stakeholder") || skillName.includes("Executive Presence") || skillName.includes("Crisis Leadership") || skillName.includes("High-Pressure")) {
                    domains["Leadership & Interpersonal"].skills.push(skill);
                } else if (skillName.includes("Creative") || skillName.includes("Musical") || skillName.includes("Music") || skillName.includes("Stage") || skillName.includes("Performance Logistics")) {
                    domains["Creative & Performance"].skills.push(skill);
                } else if (skillName.includes("Pilot") || skillName.includes("IFR") || skillName.includes("Weather") || skillName.includes("ATC") || skillName.includes("Emergency") || skillName.includes("Aeronautical") || skillName.includes("Situational Awareness") || skillName.includes("Cognitive Load")) {
                    domains["Aviation & Operational"].skills.push(skill);
                } else if (skillName.includes("Data-Driven") || skillName.includes("Market") || skillName.includes("Research") || skillName.includes("Critical Analysis")) {
                    domains["Analytical & Research"].skills.push(skill);
                } else if (skillName.includes("Recovery") || skillName.includes("Mental Health") || skillName.includes("Nonprofit") || skillName.includes("Vulnerability") || skillName.includes("Stigma") || skillName.includes("Diagnosis")) {
                    domains["Advocacy & Lived Experience"].skills.push(skill);
                }
            });
            
            let html = '<div class="cards-grid">';
            
            Object.entries(domains).forEach(([domainName, data]) => {
                if (data.skills.length === 0) return;
                
                html += `
                    <div class="domain-card">
                        <div class="domain-header">
                            <span class="domain-icon">${data.icon}</span>
                            <span class="domain-title">${domainName}</span>
                        </div>
                        <div class="skills-list">
                `;
                
                data.skills.forEach(skill => {
                    const levelClass = skill.level.toLowerCase();
                    const keyBadge = skill.key ? '<span class="skill-badge">CORE</span>' : '';
                    const rolesList = skill.roles.map(roleId => {
                        const role = skillsData.roles.find(r => r.id === roleId);
                        return role ? role.name : roleId;
                    }).join(', ');
                    
                    // Get years of experience from skillDetails
                    const details = skillsData.skillDetails && skillsData.skillDetails[skill.name];
                    const years = details && details.years ? details.years + ' yrs' : '';
                    const yearsBadge = years ? `<span class="skill-years">${years}</span>` : '';
                    
                    html += `
                        <div class="skill-item ${levelClass}" title="${rolesList}" onclick='openSkillModalFromCard("${skill.name.replace(/'/g, "\\'")}")' style="cursor: pointer;">
                            <div class="skill-dot" style="background: ${levelColors[skill.level]}"></div>
                            <span class="skill-name">${skill.name}</span>
                            ${yearsBadge}
                            ${keyBadge}
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            cardView.innerHTML = html;
        }

        function switchView(view) {
            currentView = view;
            document.querySelectorAll('.view-toggle button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const networkControls = document.getElementById('networkControls');
            
            // Hide all views
            document.getElementById('networkView').style.display = 'none';
            document.getElementById('cardView').style.display = 'none';
            document.getElementById('opportunitiesView').style.display = 'none';
            networkControls.style.display = 'none';
            
            // Show selected view
            if (view === 'network') {
                document.getElementById('networkView').style.display = 'block';
                networkControls.style.display = 'flex';
            } else if (view === 'card') {
                document.getElementById('cardView').style.display = 'block';
            } else if (view === 'opportunities') {
                document.getElementById('opportunitiesView').style.display = 'block';
                if (!window.opportunitiesInitialized) {
                    initOpportunities();
                    window.opportunitiesInitialized = true;
                }
            }
        }
        
        function toggleLabels(type) {
            if (!window.networkData) return;
            const { node } = window.networkData;
            
            node.selectAll('text')
                .filter(d => d.type === type)
                .classed('hidden', function() {
                    return !this.classList.contains('hidden');
                });
        }

        function filterByRole(roleId) {
            activeRole = roleId;
            
            // Update UI
            document.querySelectorAll('.role-chip').forEach(chip => {
                chip.classList.toggle('active', chip.dataset.role === roleId);
            });

            if (!window.networkData) return;

            const { nodes, links, node, link } = window.networkData;

            if (roleId === 'all') {
                node.classed('dimmed', false).classed('highlighted', false);
                link.classed('dimmed', false).classed('highlighted', false);
                
                // Show all labels
                node.selectAll('text').classed('hidden', false);
                return;
            }

            // Find skills that belong to this role
            const relevantSkills = skillsData.skills
                .filter(s => s.roles.includes(roleId))
                .map((s, i) => `skill-${skillsData.skills.indexOf(s)}`);

            node.classed('dimmed', d => {
                if (d.type === 'center') return false;
                if (d.type === 'role') return d.id !== roleId;
                return !relevantSkills.includes(d.id);
            });

            node.classed('highlighted', d => {
                if (d.type === 'role') return d.id === roleId;
                return relevantSkills.includes(d.id);
            });

            link.classed('dimmed', d => {
                return d.source.id !== roleId && !relevantSkills.includes(d.target.id);
            });

            link.classed('highlighted', d => {
                return d.source.id === roleId && relevantSkills.includes(d.target.id);
            });
            
            // STORYTELLING MODE: Hide skill labels that aren't in this role
            node.selectAll('text').classed('hidden', function(d) {
                if (d.type === 'center') return false;
                if (d.type === 'role') return d.id !== roleId; // Hide non-active role labels
                return !relevantSkills.includes(d.id); // Hide non-relevant skill labels
            });
        }

        function filterByLevel(level) {
            activeLevel = activeLevel === level ? null : level;
            
            event.target.classList.toggle('active');

            if (!window.networkData) return;
            const { node } = window.networkData;

            if (!activeLevel) {
                node.classed('dimmed', false);
                return;
            }

            node.classed('dimmed', d => {
                if (d.type !== 'skill') return false;
                return d.level.toLowerCase() !== activeLevel;
            });
        }

        function highlightSkill(skillData) {
            if (!window.networkData) return;
            const { node, link } = window.networkData;

            // Highlight the skill and its connected roles
            const connectedRoles = skillData.roles;

            node.classed('dimmed', d => {
                if (d.type === 'center') return false;
                if (d.type === 'role') return !connectedRoles.includes(d.id);
                return d.id !== skillData.id;
            });

            node.classed('highlighted', d => {
                if (d.type === 'role') return connectedRoles.includes(d.id);
                return d.id === skillData.id;
            });

            link.classed('highlighted', d => {
                return d.target.id === skillData.id;
            });
        }

        function showTooltip(event, d) {
            if (d.type === 'center') return;

            const tooltip = d3.select('#tooltip');
            let html = `<div class="tooltip-title">${d.name}</div>`;

            if (d.type === 'skill') {
                html += `<div class="tooltip-level">${d.level}${d.key ? ' â€¢ Core Differentiator' : ''}</div>`;
                html += `<div class="tooltip-roles">Used in: `;
                d.roles.forEach(roleId => {
                    const role = skillsData.roles.find(r => r.id === roleId);
                    html += `<span class="tooltip-role-tag">${role.name}</span>`;
                });
                html += `</div>`;
            } else if (d.type === 'role') {
                const skillCount = skillsData.skills.filter(s => s.roles.includes(d.id)).length;
                html += `<div class="tooltip-roles">${skillCount} skills in this role</div>`;
            }

            tooltip
                .html(html)
                .style('opacity', 1)
                .style('left', (event.pageX + 10) + 'px')
                .style('top', (event.pageY - 10) + 'px');
        }

        function hideTooltip() {
            d3.select('#tooltip').style('opacity', 0);
        }

        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            if (d.type !== 'center') {
                d.fx = null;
                d.fy = null;
            }
        }

        function openExportModal() {
            document.getElementById('exportModal').classList.add('active');
        }

        function closeExportModal() {
            document.getElementById('exportModal').classList.remove('active');
        }
        
        function openSkillModal(skillName, skillData) {
            const modal = document.getElementById('skillModal');
            const title = document.getElementById('skillDetailTitle');
            const subtitle = document.getElementById('skillDetailSubtitle');
            const body = document.getElementById('skillDetailBody');
            
            // Set title
            title.textContent = skillName;
            
            // Set subtitle (level, years, core badge)
            const levelClass = skillData.level.toLowerCase();
            const coreBadge = skillData.key ? '<span class="modal-core-badge">â­ CORE DIFFERENTIATOR</span>' : '';
            const details = skillsData.skillDetails[skillName] || {};
            const years = details.years || 'N/A';
            
            subtitle.innerHTML = `
                <span class="modal-level-badge ${levelClass}">${skillData.level}</span>
                <span class="modal-years">${years} years experience</span>
                ${coreBadge}
            `;
            
            // Build body content
            let bodyHTML = '';
            
            // Roles section
            bodyHTML += `
                <div class="modal-section">
                    <div class="modal-section-title">
                        <span class="modal-section-icon">ðŸŽ¯</span>
                        Used in These Roles
                    </div>
                    <div class="roles-tags">
            `;
            skillData.roles.forEach(roleId => {
                const role = skillsData.roles.find(r => r.id === roleId);
                if (role) {
                    bodyHTML += `<div class="role-tag">${role.icon} ${role.name}</div>`;
                }
            });
            bodyHTML += `</div></div>`;
            
            // Evidence section
            if (details.evidence && details.evidence.length > 0) {
                bodyHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <span class="modal-section-icon">âœ“</span>
                            Evidence & Defensibility
                        </div>
                        <ul class="evidence-list">
                `;
                details.evidence.forEach(item => {
                    bodyHTML += `<li class="evidence-item">${item}</li>`;
                });
                bodyHTML += `</ul></div>`;
            } else {
                bodyHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <span class="modal-section-icon">âœ“</span>
                            Evidence & Defensibility
                        </div>
                        <p class="placeholder-text">Evidence for this skill will be added soon.</p>
                    </div>
                `;
            }
            
            // Story section
            if (details.story) {
                bodyHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <span class="modal-section-icon">ðŸ“–</span>
                            Context & Story
                        </div>
                        <div class="story-text">${details.story}</div>
                    </div>
                `;
            }
            
            // Related skills section
            if (details.relatedSkills && details.relatedSkills.length > 0) {
                bodyHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <span class="modal-section-icon">ðŸ”—</span>
                            Related Skills
                        </div>
                        <div class="related-skills">
                `;
                details.relatedSkills.forEach(relatedSkill => {
                    bodyHTML += `<div class="related-skill-chip" onclick="openRelatedSkill('${relatedSkill}')">${relatedSkill}</div>`;
                });
                bodyHTML += `</div></div>`;
            }
            
            body.innerHTML = bodyHTML;
            modal.classList.add('active');
        }
        
        function closeSkillModal() {
            document.getElementById('skillModal').classList.remove('active');
        }
        
        function openRelatedSkill(skillName) {
            const skill = skillsData.skills.find(s => s.name === skillName);
            if (skill) {
                openSkillModal(skillName, skill);
            }
        }
        
        function openSkillModalFromCard(skillName) {
            const skill = skillsData.skills.find(s => s.name === skillName);
            if (skill) {
                openSkillModal(skillName, skill);
            }
        }

        function exportProfile(format) {
            alert(`Export to ${format} - Coming soon!\n\nThis will generate a ${format} based on your current role filter: ${activeRole}`);
            closeExportModal();
        }

        // Resize handler
        
        // ===== OPPORTUNITIES SYSTEM =====
        
        let currentMatchThreshold = 60;
        let opportunitiesData = [];
        
        function initOpportunities() {
            const view = document.getElementById('opportunitiesView');
            
            view.innerHTML = `
                <div class="opportunities-header">
                    <h2 class="opportunities-title">Job Opportunities</h2>
                    <p class="opportunities-subtitle">Matching your skills to open positions across the US</p>
                    
                    <div class="opportunities-filters">
                        <div class="filter-section">
                            <label class="filter-section-label">Minimum Match Score</label>
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <input type="range" min="0" max="100" value="60" class="match-slider" 
                                       oninput="updateMatchThreshold(this.value)">
                                <span class="match-value" id="matchValue">60%+</span>
                            </div>
                        </div>
                        
                        <div class="filter-section">
                            <label class="filter-section-label">Search Roles</label>
                            <button class="action-btn" onclick="searchOpportunities()" style="width: auto;">
                                ðŸ” Find Matching Jobs
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="opportunitiesResults"></div>
            `;
            
            // Load sample data for now
            loadSampleOpportunities();
        }
        
        function updateMatchThreshold(value) {
            currentMatchThreshold = parseInt(value);
            document.getElementById('matchValue').textContent = value + '%+';
            filterOpportunities();
        }
        
        function calculateMatchScore(jobSkills, requiredSkills) {
            let totalPoints = 0;
            let earnedPoints = 0;
            let matchedSkills = [];
            let gapSkills = [];
            
            // Build lookup of your skills
            const yourSkillsMap = {};
            skillsData.skills.forEach(skill => {
                yourSkillsMap[skill.name.toLowerCase()] = skill;
                // Also add simplified versions
                const simplified = skill.name.toLowerCase()
                    .replace(/\s*&\s*/g, ' ')
                    .replace(/\s+/g, ' ')
                    .trim();
                yourSkillsMap[simplified] = skill;
            });
            
            // Score each required skill
            requiredSkills.forEach(reqSkill => {
                const reqLower = reqSkill.toLowerCase();
                let matched = false;
                let matchPoints = 5; // base points for any match
                
                // Try exact match first
                if (yourSkillsMap[reqLower]) {
                    const yourSkill = yourSkillsMap[reqLower];
                    matched = true;
                    
                    // Weight by proficiency
                    if (yourSkill.level === 'Mastery') {
                        matchPoints = 10;
                    } else if (yourSkill.level === 'Advanced') {
                        matchPoints = 7;
                    } else if (yourSkill.level === 'Proficient') {
                        matchPoints = 5;
                    }
                    
                    // Bonus for core differentiators
                    if (yourSkill.key) {
                        matchPoints += 5;
                    }
                    
                    matchedSkills.push(yourSkill.name);
                } else {
                    // Try fuzzy matching for related skills
                    for (const [skillName, skillData] of Object.entries(yourSkillsMap)) {
                        if (reqLower.includes(skillName) || skillName.includes(reqLower)) {
                            matched = true;
                            matchPoints = 3; // partial match points
                            matchedSkills.push(skillData.name);
                            break;
                        }
                    }
                }
                
                totalPoints += 10; // Each required skill worth 10 points max
                if (matched) {
                    earnedPoints += matchPoints;
                } else {
                    gapSkills.push(reqSkill);
                }
            });
            
            const matchPercent = totalPoints > 0 ? Math.round((earnedPoints / totalPoints) * 100) : 0;
            
            return {
                score: matchPercent,
                matched: [...new Set(matchedSkills)], // Remove duplicates
                gaps: gapSkills
            };
        }
        
        function loadSampleOpportunities() {
            // Sample job data - in production this would come from web scraping
            const sampleJobs = [
                {
                    id: 1,
                    title: "VP of AI Strategy",
                    company: "TechCorp",
                    location: "San Francisco, CA",
                    type: "Full-time",
                    requiredSkills: ["Enterprise AI Strategy", "Strategic Foresight & Market Prediction", "C-Suite Advisory & Influence", "Technology Trend Forecasting", "Business Case Development", "Go-to-Market Strategy"]
                },
                {
                    id: 2,
                    title: "Chief Strategy Officer",
                    company: "GrowthCo",
                    location: "New York, NY",
                    type: "Full-time",
                    requiredSkills: ["Go-to-Market Strategy", "Business Case Development", "Strategic Foresight & Market Prediction", "Multi-Stakeholder Alignment", "Revenue Pipeline Development", "Financial Management & Budget Discipline"]
                },
                {
                    id: 3,
                    title: "Director of Technology Strategy",
                    company: "Innovation Labs",
                    location: "Austin, TX",
                    type: "Full-time",
                    requiredSkills: ["Technology Lifecycle & Disruption Analysis", "Platform Integration Architecture", "Computational & Systems Thinking", "Data-Driven Strategy Development", "Market & Competitive Intelligence"]
                },
                {
                    id: 4,
                    title: "Head of Talent Intelligence",
                    company: "WorkTech Inc",
                    location: "Remote",
                    type: "Full-time",
                    requiredSkills: ["Talent Intelligence Platform Design", "Workforce Intelligence & Analytics", "AI/ML Product Strategy", "Candidate Experience Architecture", "Talent Acquisition Strategy", "HR Technology Market Intelligence"]
                },
                {
                    id: 5,
                    title: "Chief Evangelist",
                    company: "AI Startup",
                    location: "Boston, MA",
                    type: "Full-time",
                    requiredSkills: ["Industry Evangelism", "Technical Concept Translation", "Thought Leadership Authorship", "Public Speaking & Keynote Delivery", "Media Relations & Spokesperson Work"]
                },
                {
                    id: 6,
                    title: "VP of Product Strategy",
                    company: "SaaS Platform",
                    location: "Seattle, WA",
                    type: "Full-time",
                    requiredSkills: ["AI/ML Product Strategy", "Human-AI Collaboration Model Design", "Predictive Framework Development", "Scenario Planning & Strategic Alternatives", "Disruptive Innovation Identification"]
                }
            ];
            
            // Calculate match scores
            opportunitiesData = sampleJobs.map(job => {
                const match = calculateMatchScore(job.requiredSkills, job.requiredSkills);
                return {
                    ...job,
                    matchScore: match.score,
                    matchedSkills: match.matched,
                    gapSkills: match.gaps
                };
            });
            
            // Sort by match score
            opportunitiesData.sort((a, b) => b.matchScore - a.matchScore);
            
            renderOpportunities();
        }
        
        function filterOpportunities() {
            renderOpportunities();
        }
        
        function renderOpportunities() {
            const filtered = opportunitiesData.filter(job => job.matchScore >= currentMatchThreshold);
            const resultsDiv = document.getElementById('opportunitiesResults');
            
            if (filtered.length === 0) {
                resultsDiv.innerHTML = `
                    <div class="loading-state">
                        <p style="font-size: 1.2em;">No opportunities match your current filters</p>
                        <p style="margin-top: 10px;">Try lowering the match threshold or searching for new jobs</p>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="opportunities-grid">';
            
            filtered.forEach(job => {
                const matchClass = job.matchScore >= 80 ? 'high' : job.matchScore >= 60 ? 'medium' : 'low';
                
                html += `
                    <div class="opportunity-card" onclick="viewOpportunityDetail(${job.id})">
                        <div class="opportunity-header">
                            <div>
                                <div class="opportunity-company">${job.company}</div>
                                <div class="opportunity-title">${job.title}</div>
                            </div>
                            <div class="match-score">
                                <div class="match-circle ${matchClass}">
                                    ${job.matchScore}%
                                </div>
                                <div class="match-label">Match</div>
                            </div>
                        </div>
                        
                        <div class="opportunity-meta">
                            <div class="meta-item">ðŸ“ ${job.location}</div>
                            <div class="meta-item">ðŸ’¼ ${job.type}</div>
                        </div>
                        
                        <div class="matched-skills">
                            <div class="matched-skills-title">Your Matching Skills (${job.matchedSkills.length})</div>
                            <div class="skill-chips">
                                ${job.matchedSkills.slice(0, 5).map(skill => 
                                    `<span class="skill-chip-match">${skill}</span>`
                                ).join('')}
                                ${job.matchedSkills.length > 5 ? 
                                    `<span class="skill-chip-match">+${job.matchedSkills.length - 5} more</span>` : ''}
                            </div>
                        </div>
                        
                        ${job.gapSkills.length > 0 ? `
                            <div class="matched-skills">
                                <div class="matched-skills-title">Skills to Highlight (${job.gapSkills.length})</div>
                                <div class="skill-chips">
                                    ${job.gapSkills.slice(0, 3).map(skill => 
                                        `<span class="skill-chip-gap">${skill}</span>`
                                    ).join('')}
                                    ${job.gapSkills.length > 3 ? 
                                        `<span class="skill-chip-gap">+${job.gapSkills.length - 3} more</span>` : ''}
                                </div>
                            </div>
                        ` : ''}
                        
                        <div class="opportunity-actions">
                            <button class="action-btn" onclick="event.stopPropagation(); generatePitch(${job.id})">
                                âœï¸ Generate Pitch
                            </button>
                            <button class="action-btn" onclick="event.stopPropagation(); viewOnNetwork(${job.id})">
                                ðŸ—ºï¸ View on Network
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            resultsDiv.innerHTML = html;
        }
        
        function searchOpportunities() {
            const resultsDiv = document.getElementById('opportunitiesResults');
            resultsDiv.innerHTML = `
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <p style="font-size: 1.2em;">Searching for opportunities...</p>
                    <p style="margin-top: 10px; color: #6b7280;">This feature will scrape job boards in the next update</p>
                </div>
            `;
            
            // Simulate loading
            setTimeout(() => {
                renderOpportunities();
            }, 2000);
        }
        
        function viewOpportunityDetail(jobId) {
            const job = opportunitiesData.find(j => j.id === jobId);
            alert(`Detailed view for ${job.title} at ${job.company}\n\nMatch: ${job.matchScore}%\nMatched Skills: ${job.matchedSkills.length}\nGaps: ${job.gapSkills.length}\n\nFull detail view coming in next update!`);
        }
        
        function generatePitch(jobId) {
            const job = opportunitiesData.find(j => j.id === jobId);
            alert(`Pitch generator for ${job.title}\n\nThis will use your skill evidence to generate a customized cover letter.\n\nComing in next update!`);
        }
        
        function viewOnNetwork(jobId) {
            const job = opportunitiesData.find(j => j.id === jobId);
            alert(`Network visualization for ${job.title}\n\nThis will highlight your matching skills on the network graph.\n\nComing in next update!`);
        }

        window.addEventListener('resize', () => {
            if (currentView === 'network') {
                initNetwork();
            }
        });
    </script>
</body>
</html>
