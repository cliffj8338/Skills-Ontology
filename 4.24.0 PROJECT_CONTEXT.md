# Blueprint â€” Project Context
## Last Updated: 2026-02-20 (Session 13)

---

## WHAT IS BLUEPRINT

Blueprint is a career intelligence platform that maps professional skills through interactive visualizations and generates career deliverables. Built as a single-page application (~23,300 lines) in one `index.html` file. Domain: **myblueprint.work** (primary), **getblueprint.work** (redirect/marketing).

**Core insight:** "You are not your resume." Most professionals can name 15â€“20 skills. Blueprint maps 150â€“300 using a 14,000+ skill ontology (O*NET + ESCO datasets).

---

## FILE & ARCHITECTURE

**Single file:** `/mnt/user-data/outputs/index.html` â€” ~23,230 lines, ~1.07MB
**No build system.** Pure HTML/CSS/JS. CDN dependencies only.

### CDN Dependencies
- Firebase 10.7.0 (Auth, Firestore)
- jsPDF 2.5.1 (PDF generation)
- D3.js 7 (network visualization)
- Google Fonts (Outfit, JetBrains Mono)

### Global State Variables
```
fbUser, fbIsAdmin, fbDb    â€” Firebase auth/admin/Firestore
skillsData                  â€” { skills: [], roles: [] }
userData                    â€” { profile: {}, savedJobs: [], applications: [], preferences: {} }
blueprintData               â€” { outcomes: [], values: [], purpose: '' }
isReadOnlyProfile           â€” True when viewing sample as non-admin
appMode                     â€” 'demo' | 'waitlisted' | 'invited' | 'active' (admin â†’ always active)
waitlistPosition            â€” Queue number (int or null)
currentView                 â€” Current main nav view
blueprintTab                â€” 'dashboard' | 'outcomes' | 'values' | 'export'
valuationMode               â€” 'evidence' | 'potential' (drives dual cards + detail section)
skillValuations             â€” Market value data (BLS-based)
```

### Navigation Structure
```
Primary Nav:  [Skills] [Jobs] [Blueprint] [Settings]
Skills:       Network graph / Card view (toggle)
Jobs:         Find Jobs (API) / Pipeline (saved) / Tracker (applications)
Blueprint:    Dashboard / Outcomes / Values / Export
Settings:     Profile / Preferences / Privacy / Data / Theme
```

### Key Functions
```
renderBlueprint()              â€” Main Blueprint tab renderer
renderDashboardTab()           â€” Dashboard command center (session 12-13)
renderExportSection()          â€” Export tab with 4 grouped sections + exportCard() helper
generatePDF(data, targetJob)   â€” PDF gen (optional job for scouting reports)
showScoutingReportPicker()     â€” Job picker modal for scouting reports
generateScoutingReport(idx)    â€” Targeted PDF with match analysis
matchJobToProfile(parsed)      â€” 4-tier fuzzy skill matching
calculateTotalMarketValue()    â€” BLS-based salary model
exportBlueprint(format)        â€” Export dispatcher (pdf/html/json/clipboard)
switchView(view)               â€” Main nav router
deleteBlueprintOutcome(idx)    â€” Delete outcome with confirm
showWaitlist()                 â€” Waitlist registration modal
demoGate(featureName)          â€” Feature gating for demo/waitlist users
detectAppMode()                â€” Sets appMode from auth + localStorage + Firestore
```

---

## CURRENT STATE (v4.24.0+)

### Working Features
- **Skills:** D3 force network, card view, role grouping, proficiency levels, skill modals, evidence tracking
- **Jobs:** 3 APIs (Remotive/Himalayas/Jobicy), job parsing, skill matching, pipeline, tracker
- **Blueprint Dashboard:** Career Readiness Score (SVG ring), dual valuation cards (evidence/potential), stat cards (skills/outcomes/values), skill distribution bar, inline purpose editor, collapsible market valuation, quick actions, best job match card
- **PDF Export:** Career Intelligence Report (cover, skill architecture, network viz, proficiency charts, evidence, values, market valuation, job pipeline, back cover)
- **Scouting Report:** Targeted PDF (match overview, alignment table, gap analysis, surplus value, talking points)
- **Export Tab:** Organized into 4 sections (Career Intelligence, Job-Specific Tools, Networking & Profile, Data & Backup) with reusable card helper
- **Market Valuation:** BLS OEWS model, compa-ratio, role tiers, impact skills, evidence vs potential
- **Firebase:** Google auth, Firestore, admin roles, waitlist collection
- **Demo Mode:** 4-state funnel (admin auto-active), feature gating, waitlist modal, admin invites, aha-moment nudge, profile dropdown admin-gated
- **SVG Icons:** ~80 custom icons, zero emoji in Blueprint section
- **Theming:** Dark/light with CSS variables

### Session 13 Changes (Current)
1. **Dead Code Removal** â€” removed `renderMarketValuationSection()` (218 lines) and `renderPurposeSection()` (25 lines), both superseded by Dashboard
2. **Skill Distribution Bar** â€” compact horizontal stacked bar (Mastery/Advanced/Intermediate/Foundational) with color legend, inserted between stat cards and purpose
3. **Career Readiness Score** â€” SVG score ring with percentage, status label, and actionable incomplete-item buttons; replaces old bottom completeness tracker; shows compact badge when 100%
4. **Outcomes SVG Cleanup + Delete** â€” replaced text characters (âœ“, âœŽ) with SVG icons (check, edit); replaced emoji (ðŸ”’, âœ¨) with SVG icons (lock, star) in valuation toggle; added `deleteBlueprintOutcome()` with confirm dialog
5. **Export Tab Reorganization** â€” restructured from flat grid into 4 labeled sections with dividers; added `exportCard()` helper function; Cover Letter/Interview Prep/Resume always visible (with hint when no jobs saved); moved Clipboard to Networking section
6. **Dual Valuation Cards** â€” replaced single "Market Worth" card with two top-level cards: "Evidence-Based" and "Potential", each showing its own value. Clicking a card sets `valuationMode` and refreshes. Expandable detail section now shows static mode indicator (no toggle inside).
7. **Admin Login Fix** â€” `detectAppMode()` now runs in `onAuthStateChanged` handler after admin role resolves (was only running once at startup). Admin users now always get `appMode = 'active'` as first check in `detectAppMode()`.
8. **Profile Dropdown Cleanup** â€” sample profile selector now admin-only in dropdown. Non-admin users see just Account info + Sign Out. Dropdown label dynamically shows "Admin Â· Switch Profile" vs "Account".

### Session 12 Changes
1. **Blueprint Dashboard** â€” tabs at top (sticky), stat cards, inline purpose, collapsible valuation, quick actions, completeness tracker. Purpose no longer a separate tab.
2. **Scouting Report** â€” targeted PDF: pick a job â†’ match overview (score ring), alignment table, gap analysis, surplus skills, auto-generated talking points
3. **Demo Mode Lockdown** â€” appMode system, demoGate(), waitlist modal (Firestore), admin panel with invite/bulk-invite
4. **PDF Fixes** â€” deterministic network (hashStr), roleList scoping fix

### Tech Debt
- Skill management buttons need a home (removed from Dashboard, should go to Skills tab)
- Job APIs need network access (CORS proxied)
- Consider code splitting at 25K lines
- Overflow menu "View Sample Profiles" still accessible to all users (intentional for demo browsing)

---

## LAUNCH PLAN STATUS

| Tier | Feature | Status |
|------|---------|--------|
| 1 | Demo Profile Quality | âœ… |
| 2 | PDF Export Enhancement | âœ… |
| 3 | Demo Mode Lockdown | âœ… |
| 4 | Admin Invite Emails | â¬œ |
| 5 | Polish & Psychology | ðŸ”„ In progress (session 13) |

### Gated Features (demo/waitlisted blocked)
searchOpportunities, showOnboardingWizard, openSkillManagement, openONETPicker, openCustomSkillBuilder

### Waitlist: Firestore `waitlist` collection + localStorage fallback. Admin: invite/bulk-invite. Auto-upgrade on load.

---

## PDF STRUCTURE

**Standard:** Cover â†’ Skills â†’ Network Viz â†’ Charts â†’ Evidence â†’ Values â†’ Valuation â†’ Jobs â†’ Back Cover

**Scouting Report:** Cover (with job) â†’ Match Overview (score ring) â†’ Alignment Table â†’ Gap Analysis â†’ Surplus Value â†’ Talking Points â†’ then standard pages â†’ Back Cover. Filename: `Blueprint_Name_ScoutingReport_Company_Date.pdf`

---

## MODELS

**Valuation:** BLS base + Critical/High impact premiums + rarity bonus Ã— location = Your Worth. Offers at 75/85/95%.

**Matching:** Exact (1.0) â†’ Synonym (0.95) â†’ Substring (0.85) â†’ Word overlap (0.75Ã—ratio). Weighted by RequiredÃ—3, PreferredÃ—2, NiceÃ—1.

---

## 13 SESSION HISTORY

1. Nav consolidation plan
2. v4.20.0 SVG icons + nav restructure
3. v4.20.1 UX polish
4. v4.20.2 emoji cleanup + job API research
5. v4.21.0 Find Jobs (3 APIs)
6. v4.21.0 branding
7. v4.22.0 emojiâ†’SVG (100+), mobile
8. v4.22.0 site audit (4 bugs, 439 dead lines)
9. Teaser + launch strategy + WHY_BLUEPRINT.md + LAUNCH_PLAN.md
10. PDF network viz + charts + domain branding (v4.23.0)
11. Demo mode + waitlist + scouting report + admin panel
12. Blueprint Dashboard restructure
13. Dashboard polish (readiness score, skill distribution, outcomes delete, export reorg, dead code removal) â€” THIS SESSION

---

## SUPPORTING FILES (all in /mnt/user-data/outputs/)
- `index.html` â€” Main app (~23,230 lines)
- `teaser.html` â€” Landing page with animated network
- `WHY_BLUEPRINT.md` â€” Positioning document
- `LAUNCH_PLAN.md` â€” Invite-only launch spec
- `PROJECT_CONTEXT.md` â€” This file

---

## NEXT STEPS

**Immediate:** Test admin login flow end-to-end, verify dual valuation cards, test profile dropdown admin-gating
**Short-term:** Sample profile audit, "Why Blueprint" modal, social proof, email notifications, relocate skill management buttons to Skills tab
**Medium-term:** Ambassador mechanic, analytics, LinkedIn sharing
**Tech debt:** Code splitting at 25K lines
